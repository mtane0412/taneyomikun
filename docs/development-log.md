# 開発ログ

## 2025-08-10

### HTTPサーバー機能の実装と音声読み上げシステムの改善

#### 実装内容

1. **HTTPサーバー機能の実装**
   - ポート50080でHTTPサーバーを起動
   - `/tts`エンドポイントでPOSTリクエストを受け付け
   - JSONペイロードで読み上げテキストを受信
   ```bash
   curl -X POST http://localhost:50080/tts \
     -H "Content-Type: application/json" \
     -d '{"text": "読み上げるテキスト"}'
   ```

2. **キューシステムから履歴システムへの変更**
   - 棒読みちゃんのような即座読み上げ方式に変更
   - 新しいリクエストが来たら現在の読み上げを中断して即座に開始
   - 最大100件の読み上げ履歴を保持
   - 履歴から再生・削除が可能

3. **技術的な課題と解決**
   - Tauriアプリのポート設定の不整合を修正（1420番ポートに統一）
   - イベントリスナーのクロージャー問題を解決（useRefを使用）
   - HTTPリクエストからのイベント送信をemitで実装

#### 使用技術
- Tauri v2によるHTTPサーバー統合
- Axumを使用したRust側のHTTPサーバー実装
- Zustandによる履歴状態管理
- React hooksによるイベント処理

#### 今後の課題
- HTTPサーバーの認証機能の追加
- 履歴の永続化（現在はメモリ内のみ）
- 複数テキストの連続読み上げ対応